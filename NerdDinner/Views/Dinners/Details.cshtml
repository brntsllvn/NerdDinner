@using System.Activities.Expressions
@model NerdDinner.Models.Dinner

@{
    ViewBag.Title = "Details";
}

<h2>Details</h2>

<div>
    <h4>@Model.Title</h4>
    <p>
        <strong>When:</strong>
        @Model.EventDate.ToShortDateString()
    </p>
    <p>
        <strong>Where:</strong>
        @Html.Encode(Model.Address),
        @Html.Encode(Model.Country)
    </p>
</div>

<div id="rsvpmsg">

    @if (Request.IsAuthenticated)
    {
        if (Model.IsUserRegistered(Context.User.Identity.Name))
        {
            <p>You are registered for this event!</p>
        }
        else
        {
            <p>
                @Ajax.ActionLink(
                        "RSVP for event",
                        "Register",
                        "Dinners",
                        new { id = Model.DinnerID },
                        new AjaxOptions
                        {
                            HttpMethod = "Post",
                            UpdateTargetId = "rsvpmsg",
                            OnSuccess = "AnimateRSVPMessage"
                        }
               )
            </p>
        }
    }
    else
    {
        <p><a href="/Account/Logon">Logon</a> to RSVP for this event;</p>
    }

</div>

@Html.ActionLink("Back", "Index")

@if (Model.IsHostedBy(Context.User.Identity.Name))
{
    <p>
        @Html.ActionLink("Edit", "Edit", new { id = Model.DinnerID }) |
        @Html.ActionLink("Delete", "Delete", new { id = Model.DinnerID })
    </p>
}
